<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>

    <ion-title style="font-weight: bold;">Account</ion-title>

    <ion-buttons slot="end">
      <ion-icon style=" width: 2.5rem; height: 2.5rem;" (click)="logout()" name="log-out-outline"></ion-icon>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <br>
  <img *ngIf="users != null" style="display: block; margin: auto; width: 200px; height: 200px; border-radius: 50%;"
  src="{{users.filepath}}" />
  
  <br>
  <div style="text-align: center; margin: auto; display: block;">
    <ion-button fill="solid" shape="round" style="font-weight: bold; text-align: center;" (click)="takeImage()">Upload
      From Camera</ion-button>
    <br>
    <input fill="solid" shape="round" style="font-weight: bold; display: block; margin: auto;" id="uploadBtn"
      type="file" class="upload" (change)="uploadFile($event.target.files)" />
  </div>

  <ion-card class="ion-text-center" *ngIf="isUploading && !isUploaded">
    <ion-card-header>
      <ion-card-title>Selected File:<b>{{ fileName }}</b></ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <div *ngIf="percentage | async as pct">
        Progress: {{ pct | number }}%
        <ion-progress-bar value="{{ pct / 100 }}"></ion-progress-bar>
      </div>
      <div *ngIf="snapshot | async as snap">
        File Size: {{ snap.totalBytes | fileSizePipe }} Transfered:
        {{ snap.bytesTransferred | fileSizePipe }}
        <div *ngIf="snapshot && snap.bytesTransferred != snap.totalBytes">
          <ion-button color="warning" size="small" (click)="task.pause()" class="button is-warning">Pause</ion-button>
          <ion-button size="small" (click)="task.resume()" class="button is-info">Resume</ion-button>
          <ion-button color="danger" size="small" (click)="task.cancel()" class="button is-danger">Cancel</ion-button>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-card class="ion-text-center" *ngIf="!isUploading && isUploaded">
    <ion-card-header>
      <ion-card-title>
        <b>{{ fileName }}</b> Uploaded!
      </ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <div *ngIf="UploadedFileURL | async as url">
        <img [src]="url" />
        <a [href]="url" target="_blank" rel="noopener">Download</a>
      </div>
      File Size: {{ fileSize | fileSizePipe }}
    </ion-card-content>
  </ion-card>

  <form [formGroup]="myForm" style="padding: 1rem;" *ngIf="users != null">
    <ion-card style="padding: 1rem; display: block; text-align: center;">
      <ion-item>
        <ion-label position="floating" style="font-weight: bold; font-size: 1.25rem;">Email: </ion-label>
        <ion-input type="email" formControlName="email" disabled="true" style=" font-size: 1.1rem;"
          value="{{users.email}}"></ion-input>
      </ion-item>

      <br>

      <ion-item>
        <ion-label position="floating" style="font-weight: bold; font-size: 1.25rem;">Full Name: </ion-label>
        <ion-input type="text" formControlName="fullname" required="true" style=" font-size: 1.1rem;"
          value="{{users.fullname}}"></ion-input>
      </ion-item>

      <br>

      <ion-item>
        <ion-label style="font-weight: bold; font-size: 1.1rem;">Birthday:</ion-label>
        <ion-datetime displayFormat="DD-MMM-YYYY" pickerFormat="DD-MMM-YYYY" min="1910-01-01" max="2010-12-31"
          formControlName="birthday" style=" font-size: 1.1rem;" required="true" value="{{users.birthday}}">
        </ion-datetime>
      </ion-item>

      <br>

      <ion-item>
        <ion-label position="floating" style="font-weight: bold; font-size: 1.25rem;">Contact: </ion-label>
        <ion-input type="text" formControlName="contact" required="true" style=" font-size: 1.1rem;"
          value="{{users.contact}}"></ion-input>
      </ion-item>

    </ion-card>

    <div style="text-align: center; margin: auto; display: block;">
      <ion-button fill="solid" shape="round" style="font-weight: bold; text-align: center;" (click)="update()">Update
        Account
      </ion-button>
      <br>
      <ion-button fill="solid" shape="round" style="font-weight: bold; text-align: center;" (click)="changePassword()">
        Update Password
      </ion-button>
      <br>
      <ion-button fill="solid" shape="round" style="font-weight: bold; text-align: center;" (click)="delete()">Delete
        Account</ion-button>
    </div>

  </form>

</ion-content>